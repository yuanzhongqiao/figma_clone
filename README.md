<div align="center">
  <br />
    <a href="https://youtu.be/oKIThIihv60" target="_blank">
      <img src="https://github.com/JavaScript-Mastery-Pro/figma-ts/assets/151519281/e03dc22d-0f45-464b-9dc3-f01f07906bee" alt="Project Banner">
    </a>
  <br />

<div class="Box-sc-g0xbh4-0 bJMeLZ js-snippet-clipboard-copy-unpositioned" data-hpc="true"><article class="markdown-body entry-content container-lg" itemprop="text"><div align="center" dir="auto">
  <br>
    <a href="https://youtu.be/oKIThIihv60" rel="nofollow">
      <img src="https://private-user-images.githubusercontent.com/151519281/301733612-e03dc22d-0f45-464b-9dc3-f01f07906bee.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDcyMTU3NTMsIm5iZiI6MTcwNzIxNTQ1MywicGF0aCI6Ii8xNTE1MTkyODEvMzAxNzMzNjEyLWUwM2RjMjJkLTBmNDUtNDY0Yi05ZGMzLWYwMWYwNzkwNmJlZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwMjA2JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDIwNlQxMDMwNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1mOGE5ZWNjMGNjYTczNWIxYjlhZWYyZmNiMzBiMGM4ZmZhYzA0YTZkY2QwOWMzZTNkMDNmZTE5OTRhYTY3ZjY1JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.RreDGM3ISjeu7hF7v8ArGXG1wdMH0CMrBtukdetrTPo" alt="项目横幅" secured-asset-link="" style="max-width: 100%;">
    </a>
  <br>
  <div dir="auto">
    <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/7e573cff980c6a55d6270df38782e05f4f89c76115f622ce28c9121aea62612e/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d547970655363726970742d626c61636b3f7374796c653d666f722d7468652d6261646765266c6f676f436f6c6f723d7768697465266c6f676f3d7479706573637269707426636f6c6f723d333137384336"><img src="https://camo.githubusercontent.com/7e573cff980c6a55d6270df38782e05f4f89c76115f622ce28c9121aea62612e/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d547970655363726970742d626c61636b3f7374796c653d666f722d7468652d6261646765266c6f676f436f6c6f723d7768697465266c6f676f3d7479706573637269707426636f6c6f723d333137384336" alt="打字稿" data-canonical-src="https://img.shields.io/badge/-TypeScript-black?style=for-the-badge&amp;logoColor=white&amp;logo=typescript&amp;color=3178C6" style="max-width: 100%;"></a>
    <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/6f9d07001b55b80d6610d39025854cad249d6312b484d6ac9237e911a7eaf8e0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d4e6578745f4a532d626c61636b3f7374796c653d666f722d7468652d6261646765266c6f676f436f6c6f723d7768697465266c6f676f3d6e657874646f746a7326636f6c6f723d303030303030"><img src="https://camo.githubusercontent.com/6f9d07001b55b80d6610d39025854cad249d6312b484d6ac9237e911a7eaf8e0/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d4e6578745f4a532d626c61636b3f7374796c653d666f722d7468652d6261646765266c6f676f436f6c6f723d7768697465266c6f676f3d6e657874646f746a7326636f6c6f723d303030303030" alt="下一个点" data-canonical-src="https://img.shields.io/badge/-Next_JS-black?style=for-the-badge&amp;logoColor=white&amp;logo=nextdotjs&amp;color=000000" style="max-width: 100%;"></a>
    <a target="_blank" rel="noopener noreferrer nofollow" href="https://camo.githubusercontent.com/e69f163b0b8defad9786f979113f151063a893349c1fce6647cd7a4a334c6469/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d5461696c77696e645f4353532d626c61636b3f7374796c653d666f722d7468652d6261646765266c6f676f436f6c6f723d7768697465266c6f676f3d7461696c77696e6463737326636f6c6f723d303642364434"><img src="https://camo.githubusercontent.com/e69f163b0b8defad9786f979113f151063a893349c1fce6647cd7a4a334c6469/68747470733a2f2f696d672e736869656c64732e696f2f62616467652f2d5461696c77696e645f4353532d626c61636b3f7374796c653d666f722d7468652d6261646765266c6f676f436f6c6f723d7768697465266c6f676f3d7461696c77696e6463737326636f6c6f723d303642364434" alt="顺风CSS" data-canonical-src="https://img.shields.io/badge/-Tailwind_CSS-black?style=for-the-badge&amp;logoColor=white&amp;logo=tailwindcss&amp;color=06B6D4" style="max-width: 100%;"></a>
  </div>
  <h3 align="center" tabindex="-1" dir="auto"><a id="user-content-real-time-figma-clone" class="anchor" aria-hidden="true" tabindex="-1" href="#real-time-figma-clone"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">实时 Figma 克隆</font></font></h3>
   <div align="center" dir="auto"><font style="vertical-align: inherit;"></font><a href="https://www.youtube.com/@javascriptmastery/videos" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用我们在JavaScript Mastery</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> YouTube
     上的详细教程逐步构建此项目</font><font style="vertical-align: inherit;">。加入JSM大家庭！
    </font></font></div>
</div>
<h2 tabindex="-1" dir="auto"><a id="user-content--table-of-contents" class="anchor" aria-hidden="true" tabindex="-1" href="#-table-of-contents"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">📋</font></font><a name="user-content-table"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">目录</font></font></a></h2>
<ol dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🤖</font></font><a href="#introduction"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简介</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⚙️</font></font><a href="#tech-stack"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">技术堆栈</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🔋</font></font><a href="#features"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">特点</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🤸</font></font><a href="#quick-start"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">快速入门</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🕸️</font></font><a href="#snippets"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">片段</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🔗</font></font><a href="#links"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">链接</font></font></a></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🚀</font></font><a href="#more"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更多</font></font></a></li>
</ol>
<h2 tabindex="-1" dir="auto"><a id="user-content--tutorial" class="anchor" aria-hidden="true" tabindex="-1" href="#-tutorial"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🚨 教程</font></font></h2>
<p dir="auto"><font style="vertical-align: inherit;"></font><a href="https://www.youtube.com/@javascriptmastery/videos" rel="nofollow"><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">此存储库包含与我们的 YouTube 频道JavaScript Mastery</font></font></b></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上提供的深入教程相对应的代码</font><font style="vertical-align: inherit;">。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您喜欢视觉学习，这对您来说是完美的资源。按照我们的教程学习如何以初学者友好的方式逐步构建此类项目！</font></font></p>
<p dir="auto"><a href="https://youtu.be/oKIThIihv60" rel="nofollow"><img src="https://private-user-images.githubusercontent.com/151519281/289277158-1736fca5-a031-4854-8c09-bc110e3bc16d.svg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDcyMTU3NTMsIm5iZiI6MTcwNzIxNTQ1MywicGF0aCI6Ii8xNTE1MTkyODEvMjg5Mjc3MTU4LTE3MzZmY2E1LWEwMzEtNDg1NC04YzA5LWJjMTEwZTNiYzE2ZC5zdmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwMjA2JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDIwNlQxMDMwNTNaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0yYmU2MzJkMjJhYTQ0NDU4Njc5MTAzODYyNmJiNjJjZWU4YmI4NGJhNmVkZWE2MzU0NzhjYjQ5ZmFjZThhZjQ4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.0h-Dgj-JToDEvujtrjSP6dcNIgn8CJQgxJ42YDZm12k" secured-asset-link="" style="max-width: 100%;"></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content--introduction" class="anchor" aria-hidden="true" tabindex="-1" href="#-introduction"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><a name="user-content-introduction"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🤖 简介</font></font></a></h2>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简约的Figma克隆，展示如何使用fabric.js在画布上添加现实世界的功能，例如通过光标聊天、评论、反应和绘图设计（形状、图像上传）进行实时协作。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您刚开始使用并需要帮助或遇到任何错误，请加入我们拥有超过 27,000 名成员的活跃 Discord 社区。这是一个人们互相帮助的地方。</font></font></p>
<p dir="auto"><a href="https://discord.com/invite/n6EdbFJ" rel="nofollow"><img src="https://private-user-images.githubusercontent.com/151519281/289277498-618f4872-1e10-42da-8213-1d69e486d02e.svg?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDcyMTU3NTQsIm5iZiI6MTcwNzIxNTQ1NCwicGF0aCI6Ii8xNTE1MTkyODEvMjg5Mjc3NDk4LTYxOGY0ODcyLTFlMTAtNDJkYS04MjEzLTFkNjllNDg2ZDAyZS5zdmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwMjA2JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDIwNlQxMDMwNTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1jYmRhNTE4Yjk3NmNlN2JmNGE0ZmVhM2UyYzVlOTgxZWI2NDBiMjE5MmQzODYzMzAwMWJjZDJjZjljZGUyODM0JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.mNfoTBCve6gR2K4CzIM30azI1vmUYyn9wJ45AgJ55WI" secured-asset-link="" style="max-width: 100%;"></a></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-️-tech-stack" class="anchor" aria-hidden="true" tabindex="-1" href="#️-tech-stack"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><a name="user-content-tech-stack"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">⚙️ 技术堆栈</font></font></a></h2>
<ul dir="auto">
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Next.js</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">打字稿</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">活块</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Fabric.js</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">沙德网络</font></font></li>
<li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顺风CSS</font></font></li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content--features" class="anchor" aria-hidden="true" tabindex="-1" href="#-features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><a name="user-content-features"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🔋特点</font></font></a></h2>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">多光标、光标聊天和反应</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：允许多个用户通过显示单独的光标同时协作，启用实时聊天和交互式通信的反应。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">活跃用户</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：显示协作环境中当前活跃用户的列表，让您了解当前参与的用户。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">评论气泡</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：使用户能够将评论附加到画布上的特定元素，促进对设计组件的沟通和反馈。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建不同的形状</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：为用户提供在画布上生成各种形状的工具，允许多样化的设计元素</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上传图片</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：将图片导入到画布上，扩大设计中视觉内容的范围</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定制</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：允许用户调整设计元素的属性，提供定制和微调视觉组件的灵活性</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自由绘图</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：让用户能够在画布上自由绘图，促进艺术表达和创意设计。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">撤消/重做</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：提供撤销（撤消）或恢复（重做）先前操作的能力，为设计决策提供灵活性</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">键盘操作</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：允许用户利用键盘快捷键进行各种操作，包括复制、粘贴、删除以及触发打开光标聊天、反应等功能的快捷键，提高效率和可访问性。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">历史记录</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：查看画布上的操作和更改的时间历史记录，有助于项目管理和版本控制。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">👉</font></font><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">删除、缩放、移动、清除、导出画布</font></font></strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">：提供一系列管理设计元素的功能，包括删除、缩放、移动、清除画布以及导出最终设计供外部使用。</font></font></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">还有更多，包括代码架构、高级反应挂钩和可重用性</font></font></p>
<h2 tabindex="-1" dir="auto"><a id="user-content--quick-start" class="anchor" aria-hidden="true" tabindex="-1" href="#-quick-start"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><a name="user-content-quick-start"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🤸 快速入门</font></font></a></h2>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">按照以下步骤在您的计算机上本地设置项目。</font></font></p>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">先决条件</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">确保您的计算机上安装了以下软件：</font></font></p>
<ul dir="auto">
<li><a href="https://git-scm.com/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">git</font></font></a></li>
<li><a href="https://nodejs.org/en" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Node.js</font></font></a></li>
<li><a href="https://www.npmjs.com/" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">npm</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">（节点包管理器）</font></font></li>
</ul>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">克隆存储库</font></font></strong></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>git clone https://github.com/JavaScript-Mastery-Pro/figma-ts.git
<span class="pl-c1">cd</span> figma-ts</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="git clone https://github.com/JavaScript-Mastery-Pro/figma-ts.git
cd figma-ts" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用 npm 安装项目依赖项：</font></font></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>npm install</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="npm install" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">设置环境变量</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在项目的根目录中创建一个名为的新文件</font></font><code>.env.local</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">并添加以下内容：</font></font></p>
<div class="highlight highlight-source-dotenv notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-v">NEXT_PUBLIC_LIVEBLOCKS_PUBLIC_KEY</span><span class="pl-k">=</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="NEXT_PUBLIC_LIVEBLOCKS_PUBLIC_KEY=" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">将占位符值替换为您的实际 Liveblocks 凭据。您可以通过在</font></font><a href="https://liveblocks.io" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Liveblocks 网站</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">上注册来获取这些凭据</font><font style="vertical-align: inherit;">。</font></font></p>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">运行项目</font></font></strong></p>
<div class="highlight highlight-source-shell notranslate position-relative overflow-auto" dir="auto"><pre>npm run dev</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="npm run dev" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在浏览器中打开</font></font><a href="http://localhost:3000" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">http://localhost:3000</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查看项目。</font></font></p>
<h2 tabindex="-1" dir="auto"><a id="user-content-️-snippets" class="anchor" aria-hidden="true" tabindex="-1" href="#️-snippets"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><a name="user-content-snippets"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🕸️片段</font></font></a></h2>
<h3 tabindex="-1" dir="auto"><a id="user-content-styles" class="anchor" aria-hidden="true" tabindex="-1" href="#styles"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">风格</font></font></h3>
<details>
<summary><code>tailwind.config.ts</code></summary>
<div class="highlight highlight-source-ts notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">import</span> <span class="pl-k">type</span> <span class="pl-kos">{</span> <span class="pl-smi">Config</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"tailwindcss"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-s1">config</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
  <span class="pl-c1">darkMode</span>: <span class="pl-kos">[</span><span class="pl-s">"class"</span><span class="pl-kos">]</span><span class="pl-kos">,</span>
  <span class="pl-c1">content</span>: <span class="pl-kos">[</span>
    <span class="pl-s">"./pages/**/*.{ts,tsx}"</span><span class="pl-kos">,</span>
    <span class="pl-s">"./components/**/*.{ts,tsx}"</span><span class="pl-kos">,</span>
    <span class="pl-s">"./app/**/*.{ts,tsx}"</span><span class="pl-kos">,</span>
    <span class="pl-s">"./src/**/*.{ts,tsx}"</span><span class="pl-kos">,</span>
  <span class="pl-kos">]</span><span class="pl-kos">,</span>
  <span class="pl-c1">prefix</span>: <span class="pl-s">""</span><span class="pl-kos">,</span>
  <span class="pl-c1">theme</span>: <span class="pl-kos">{</span>
    <span class="pl-c1">container</span>: <span class="pl-kos">{</span>
      <span class="pl-c1">center</span>: <span class="pl-c1">true</span><span class="pl-kos">,</span>
      <span class="pl-c1">padding</span>: <span class="pl-s">"2rem"</span><span class="pl-kos">,</span>
      <span class="pl-c1">screens</span>: <span class="pl-kos">{</span>
        <span class="pl-s">"2xl"</span>: <span class="pl-s">"1400px"</span><span class="pl-kos">,</span>
      <span class="pl-kos">}</span><span class="pl-kos">,</span>
    <span class="pl-kos">}</span><span class="pl-kos">,</span>
    <span class="pl-c1">extend</span>: <span class="pl-kos">{</span>
      <span class="pl-c1">colors</span>: <span class="pl-kos">{</span>
        <span class="pl-c1">primary</span>: <span class="pl-kos">{</span>
          <span class="pl-c1">black</span>: <span class="pl-s">"#14181F"</span><span class="pl-kos">,</span>
          <span class="pl-c1">green</span>: <span class="pl-s">"#56FFA6"</span><span class="pl-kos">,</span>
          <span class="pl-c1">grey</span>: <span class="pl-kos">{</span>
            <span class="pl-c1">100</span>: <span class="pl-s">"#2B303B"</span><span class="pl-kos">,</span>
            <span class="pl-c1">200</span>: <span class="pl-s">"#202731"</span><span class="pl-kos">,</span>
            <span class="pl-c1">300</span>: <span class="pl-s">"#C4D3ED"</span><span class="pl-kos">,</span>
          <span class="pl-kos">}</span><span class="pl-kos">,</span>
        <span class="pl-kos">}</span><span class="pl-kos">,</span>
      <span class="pl-kos">}</span><span class="pl-kos">,</span>
      <span class="pl-c1">keyframes</span>: <span class="pl-kos">{</span>
        <span class="pl-s">"accordion-down"</span>: <span class="pl-kos">{</span>
          <span class="pl-c1">from</span>: <span class="pl-kos">{</span> <span class="pl-c1">height</span>: <span class="pl-s">"0"</span> <span class="pl-kos">}</span><span class="pl-kos">,</span>
          <span class="pl-c1">to</span>: <span class="pl-kos">{</span> <span class="pl-c1">height</span>: <span class="pl-s">"var(--radix-accordion-content-height)"</span> <span class="pl-kos">}</span><span class="pl-kos">,</span>
        <span class="pl-kos">}</span><span class="pl-kos">,</span>
        <span class="pl-s">"accordion-up"</span>: <span class="pl-kos">{</span>
          <span class="pl-c1">from</span>: <span class="pl-kos">{</span> <span class="pl-c1">height</span>: <span class="pl-s">"var(--radix-accordion-content-height)"</span> <span class="pl-kos">}</span><span class="pl-kos">,</span>
          <span class="pl-c1">to</span>: <span class="pl-kos">{</span> <span class="pl-c1">height</span>: <span class="pl-s">"0"</span> <span class="pl-kos">}</span><span class="pl-kos">,</span>
        <span class="pl-kos">}</span><span class="pl-kos">,</span>
      <span class="pl-kos">}</span><span class="pl-kos">,</span>
      <span class="pl-c1">animation</span>: <span class="pl-kos">{</span>
        <span class="pl-s">"accordion-down"</span>: <span class="pl-s">"accordion-down 0.2s ease-out"</span><span class="pl-kos">,</span>
        <span class="pl-s">"accordion-up"</span>: <span class="pl-s">"accordion-up 0.2s ease-out"</span><span class="pl-kos">,</span>
      <span class="pl-kos">}</span><span class="pl-kos">,</span>
    <span class="pl-kos">}</span><span class="pl-kos">,</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span>
  <span class="pl-c1">plugins</span>: <span class="pl-kos">[</span><span class="pl-en">require</span><span class="pl-kos">(</span><span class="pl-s">"tailwindcss-animate"</span><span class="pl-kos">)</span><span class="pl-kos">]</span><span class="pl-kos">,</span>
<span class="pl-kos">}</span> <span class="pl-s1">satisfies</span> <span class="pl-smi">Config</span><span class="pl-kos">;</span>

<span class="pl-k">export</span> <span class="pl-k">default</span> <span class="pl-s1">config</span><span class="pl-kos">;</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="import type { Config } from &quot;tailwindcss&quot;;

const config = {
  darkMode: [&quot;class&quot;],
  content: [
    &quot;./pages/**/*.{ts,tsx}&quot;,
    &quot;./components/**/*.{ts,tsx}&quot;,
    &quot;./app/**/*.{ts,tsx}&quot;,
    &quot;./src/**/*.{ts,tsx}&quot;,
  ],
  prefix: &quot;&quot;,
  theme: {
    container: {
      center: true,
      padding: &quot;2rem&quot;,
      screens: {
        &quot;2xl&quot;: &quot;1400px&quot;,
      },
    },
    extend: {
      colors: {
        primary: {
          black: &quot;#14181F&quot;,
          green: &quot;#56FFA6&quot;,
          grey: {
            100: &quot;#2B303B&quot;,
            200: &quot;#202731&quot;,
            300: &quot;#C4D3ED&quot;,
          },
        },
      },
      keyframes: {
        &quot;accordion-down&quot;: {
          from: { height: &quot;0&quot; },
          to: { height: &quot;var(--radix-accordion-content-height)&quot; },
        },
        &quot;accordion-up&quot;: {
          from: { height: &quot;var(--radix-accordion-content-height)&quot; },
          to: { height: &quot;0&quot; },
        },
      },
      animation: {
        &quot;accordion-down&quot;: &quot;accordion-down 0.2s ease-out&quot;,
        &quot;accordion-up&quot;: &quot;accordion-up 0.2s ease-out&quot;,
      },
    },
  },
  plugins: [require(&quot;tailwindcss-animate&quot;)],
} satisfies Config;

export default config;" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<details>
<summary><code>app/globals.css</code></summary>
<div class="highlight highlight-source-css notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-k">@tailwind</span> base;
<span class="pl-k">@tailwind</span> components;
<span class="pl-k">@tailwind</span> utilities;

<span class="pl-k">@import</span> <span class="pl-s">"@liveblocks/react-comments/styles.css"</span>;

<span class="pl-ent"><span class="pl-c1">*</span></span> {
  <span class="pl-c1">font-family</span><span class="pl-kos">:</span>
    work sans<span class="pl-kos">,</span>
    sans-serif;
}

<span class="pl-k">@layer</span> utilities {
  .<span class="pl-c1">no-ring</span> {
    <span class="pl-k">@apply</span> outline-none ring-0 ring<span class="pl-c1">-</span>offset-0 focus<span class="pl-kos">:</span><span class="pl-c1">ring-0</span> <span class="pl-ent">focus</span><span class="pl-kos">:</span><span class="pl-c1">ring-offset-0</span> <span class="pl-ent">focus-visible</span><span class="pl-kos">:</span><span class="pl-c1">ring-offset-0</span> <span class="pl-k">!important</span>;
  }

  .<span class="pl-c1">input-ring</span> {
    <span class="pl-k">@apply</span> h-8 rounded<span class="pl-c1">-</span>none b<span class="pl-c1">or</span>der-none  bg<span class="pl-c1">-</span>transparent outline-none ring<span class="pl-c1">-</span>offset-0 focus<span class="pl-kos">:</span><span class="pl-c1">ring-1</span>  <span class="pl-ent">focus</span><span class="pl-kos">:</span><span class="pl-c1">ring-primary-green</span> <span class="pl-ent">focus</span><span class="pl-kos">:</span><span class="pl-c1">ring-offset-0</span> <span class="pl-ent">focus-visible</span><span class="pl-kos">:</span><span class="pl-c1">ring-offset-0</span> <span class="pl-k">!important</span>;
  }

  .<span class="pl-c1">right-menu-content</span> {
    <span class="pl-k">@apply</span> flex w-80 flex<span class="pl-c1">-</span>col gap<span class="pl-c1">-</span>y-1 b<span class="pl-c1">or</span>der-none bg<span class="pl-c1">-</span>primary<span class="pl-c1">-</span>black py-4 text<span class="pl-c1">-</span>white <span class="pl-k">!important</span>;
  }

  .<span class="pl-c1">right-menu-item</span> {
    <span class="pl-k">@apply</span> flex justify<span class="pl-c1">-</span>between px-3 py-2 hover<span class="pl-kos">:</span><span class="pl-c1">bg-primary-grey-200</span> <span class="pl-k">!important</span>;
  }
}</pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="@tailwind base;
@tailwind components;
@tailwind utilities;

@import &quot;@liveblocks/react-comments/styles.css&quot;;

* {
  font-family:
    work sans,
    sans-serif;
}

@layer utilities {
  .no-ring {
    @apply outline-none ring-0 ring-offset-0 focus:ring-0 focus:ring-offset-0 focus-visible:ring-offset-0 !important;
  }

  .input-ring {
    @apply h-8 rounded-none border-none  bg-transparent outline-none ring-offset-0 focus:ring-1  focus:ring-primary-green focus:ring-offset-0 focus-visible:ring-offset-0 !important;
  }

  .right-menu-content {
    @apply flex w-80 flex-col gap-y-1 border-none bg-primary-black py-4 text-white !important;
  }

  .right-menu-item {
    @apply flex justify-between px-3 py-2 hover:bg-primary-grey-200 !important;
  }
}" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<h3 tabindex="-1" dir="auto"><a id="user-content-overlay-comments" class="anchor" aria-hidden="true" tabindex="-1" href="#overlay-comments"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">叠加评论</font></font></h3>
<details>
<summary><code>NewThread</code></summary>
<div class="highlight highlight-source-tsx notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s">"use client"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-kos">{</span>
  <span class="pl-smi">FormEvent</span><span class="pl-kos">,</span>
  <span class="pl-smi">ReactNode</span><span class="pl-kos">,</span>
  <span class="pl-s1">useCallback</span><span class="pl-kos">,</span>
  <span class="pl-s1">useEffect</span><span class="pl-kos">,</span>
  <span class="pl-s1">useRef</span><span class="pl-kos">,</span>
  <span class="pl-s1">useState</span><span class="pl-kos">,</span>
<span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"react"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">Slot</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@radix-ui/react-slot"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-c1">*</span> <span class="pl-k">as</span> <span class="pl-smi">Portal</span> <span class="pl-k">from</span> <span class="pl-s">"@radix-ui/react-portal"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">ComposerSubmitComment</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@liveblocks/react-comments/primitives"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">useCreateThread</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@/liveblocks.config"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">useMaxZIndex</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@/lib/useMaxZIndex"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-smi">PinnedComposer</span> <span class="pl-k">from</span> <span class="pl-s">"./PinnedComposer"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-smi">NewThreadCursor</span> <span class="pl-k">from</span> <span class="pl-s">"./NewThreadCursor"</span><span class="pl-kos">;</span>

<span class="pl-k">type</span> <span class="pl-smi">ComposerCoords</span> <span class="pl-c1">=</span> <span class="pl-c1">null</span> <span class="pl-c1">|</span> <span class="pl-kos">{</span> <span class="pl-c1">x</span>: <span class="pl-smi">number</span><span class="pl-kos">;</span> <span class="pl-c1">y</span>: <span class="pl-smi">number</span> <span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">type</span> <span class="pl-smi">Props</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
  <span class="pl-c1">children</span>: <span class="pl-smi">ReactNode</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">export</span> <span class="pl-k">const</span> <span class="pl-smi">NewThread</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-kos">{</span> children <span class="pl-kos">}</span>: <span class="pl-smi">Props</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-c">// set state to track if we're placing a new comment or not</span>
  <span class="pl-k">const</span> <span class="pl-kos">[</span><span class="pl-s1">creatingCommentState</span><span class="pl-kos">,</span> <span class="pl-s1">setCreatingCommentState</span><span class="pl-kos">]</span> <span class="pl-c1">=</span> <span class="pl-en">useState</span><span class="pl-kos">&lt;</span>
    <span class="pl-s">"placing"</span> <span class="pl-c1">|</span> <span class="pl-s">"placed"</span> <span class="pl-c1">|</span> <span class="pl-s">"complete"</span>
  <span class="pl-kos">&gt;</span><span class="pl-kos">(</span><span class="pl-s">"complete"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">/**</span>
<span class="pl-c">   * We're using the useCreateThread hook to create a new thread.</span>
<span class="pl-c">   *</span>
<span class="pl-c">   * useCreateThread: https://liveblocks.io/docs/api-reference/liveblocks-react#useCreateThread</span>
<span class="pl-c">   */</span>
  <span class="pl-k">const</span> <span class="pl-s1">createThread</span> <span class="pl-c1">=</span> <span class="pl-en">useCreateThread</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">// get the max z-index of a thread</span>
  <span class="pl-k">const</span> <span class="pl-s1">maxZIndex</span> <span class="pl-c1">=</span> <span class="pl-en">useMaxZIndex</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">// set state to track the coordinates of the composer (liveblocks comment editor)</span>
  <span class="pl-k">const</span> <span class="pl-kos">[</span><span class="pl-s1">composerCoords</span><span class="pl-kos">,</span> <span class="pl-s1">setComposerCoords</span><span class="pl-kos">]</span> <span class="pl-c1">=</span> <span class="pl-en">useState</span><span class="pl-kos">&lt;</span><span class="pl-smi">ComposerCoords</span><span class="pl-kos">&gt;</span><span class="pl-kos">(</span><span class="pl-c1">null</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">// set state to track the last pointer event</span>
  <span class="pl-k">const</span> <span class="pl-s1">lastPointerEvent</span> <span class="pl-c1">=</span> <span class="pl-en">useRef</span><span class="pl-kos">&lt;</span><span class="pl-smi">PointerEvent</span><span class="pl-kos">&gt;</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">// set state to track if user is allowed to use the composer</span>
  <span class="pl-k">const</span> <span class="pl-kos">[</span><span class="pl-s1">allowUseComposer</span><span class="pl-kos">,</span> <span class="pl-s1">setAllowUseComposer</span><span class="pl-kos">]</span> <span class="pl-c1">=</span> <span class="pl-en">useState</span><span class="pl-kos">(</span><span class="pl-c1">false</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-k">const</span> <span class="pl-s1">allowComposerRef</span> <span class="pl-c1">=</span> <span class="pl-en">useRef</span><span class="pl-kos">(</span><span class="pl-s1">allowUseComposer</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-s1">allowComposerRef</span><span class="pl-kos">.</span><span class="pl-c1">current</span> <span class="pl-c1">=</span> <span class="pl-s1">allowUseComposer</span><span class="pl-kos">;</span>

  <span class="pl-en">useEffect</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-c">// If composer is already placed, don't do anything</span>
    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">creatingCommentState</span> <span class="pl-c1">===</span> <span class="pl-s">"complete"</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-k">return</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>

    <span class="pl-c">// Place a composer on the screen</span>
    <span class="pl-k">const</span> <span class="pl-en">newComment</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-s1">e</span>: <span class="pl-smi">MouseEvent</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-en">preventDefault</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

      <span class="pl-c">// If already placed, click outside to close composer</span>
      <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">creatingCommentState</span> <span class="pl-c1">===</span> <span class="pl-s">"placed"</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
        <span class="pl-c">// check if the click event is on/inside the composer</span>
        <span class="pl-k">const</span> <span class="pl-s1">isClickOnComposer</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-s1">e</span> <span class="pl-k">as</span> <span class="pl-smi">any</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-c1">_savedComposedPath</span> <span class="pl-c1">=</span> <span class="pl-s1">e</span>
          <span class="pl-kos">.</span><span class="pl-en">composedPath</span><span class="pl-kos">(</span><span class="pl-kos">)</span>
          <span class="pl-kos">.</span><span class="pl-en">some</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-s1">el</span>: <span class="pl-smi">any</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
            <span class="pl-k">return</span> <span class="pl-s1">el</span><span class="pl-kos">.</span><span class="pl-c1">classList</span><span class="pl-kos">?.</span><span class="pl-en">contains</span><span class="pl-kos">(</span><span class="pl-s">"lb-composer-editor-actions"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
          <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

        <span class="pl-c">// if click is inisde/on composer, don't do anything</span>
        <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">isClickOnComposer</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
          <span class="pl-k">return</span><span class="pl-kos">;</span>
        <span class="pl-kos">}</span>

        <span class="pl-c">// if click is outside composer, close composer</span>
        <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-c1">!</span><span class="pl-s1">isClickOnComposer</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
          <span class="pl-en">setCreatingCommentState</span><span class="pl-kos">(</span><span class="pl-s">"complete"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
          <span class="pl-k">return</span><span class="pl-kos">;</span>
        <span class="pl-kos">}</span>
      <span class="pl-kos">}</span>

      <span class="pl-c">// First click sets composer down</span>
      <span class="pl-en">setCreatingCommentState</span><span class="pl-kos">(</span><span class="pl-s">"placed"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-en">setComposerCoords</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
        <span class="pl-c1">x</span>: <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">clientX</span><span class="pl-kos">,</span>
        <span class="pl-c1">y</span>: <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">clientY</span><span class="pl-kos">,</span>
      <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">;</span>

    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-s">"click"</span><span class="pl-kos">,</span> <span class="pl-s1">newComment</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

    <span class="pl-k">return</span> <span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-en">removeEventListener</span><span class="pl-kos">(</span><span class="pl-s">"click"</span><span class="pl-kos">,</span> <span class="pl-s1">newComment</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-kos">[</span><span class="pl-s1">creatingCommentState</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-en">useEffect</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-c">// If dragging composer, update position</span>
    <span class="pl-k">const</span> <span class="pl-en">handlePointerMove</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-s1">e</span>: <span class="pl-smi">PointerEvent</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-c">// Prevents issue with composedPath getting removed</span>
      <span class="pl-kos">(</span><span class="pl-s1">e</span> <span class="pl-k">as</span> <span class="pl-smi">any</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-c1">_savedComposedPath</span> <span class="pl-c1">=</span> <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-en">composedPath</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-s1">lastPointerEvent</span><span class="pl-kos">.</span><span class="pl-c1">current</span> <span class="pl-c1">=</span> <span class="pl-s1">e</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">;</span>

    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-s">"pointermove"</span><span class="pl-kos">,</span> <span class="pl-s1">handlePointerMove</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

    <span class="pl-k">return</span> <span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-en">removeEventListener</span><span class="pl-kos">(</span>
        <span class="pl-s">"pointermove"</span><span class="pl-kos">,</span>
        <span class="pl-s1">handlePointerMove</span>
      <span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-kos">[</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">// Set pointer event from last click on body for use later</span>
  <span class="pl-en">useEffect</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">creatingCommentState</span> <span class="pl-c1">!==</span> <span class="pl-s">"placing"</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-k">return</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>

    <span class="pl-k">const</span> <span class="pl-en">handlePointerDown</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-s1">e</span>: <span class="pl-smi">PointerEvent</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-c">// if composer is already placed, don't do anything</span>
      <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">allowComposerRef</span><span class="pl-kos">.</span><span class="pl-c1">current</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
        <span class="pl-k">return</span><span class="pl-kos">;</span>
      <span class="pl-kos">}</span>

      <span class="pl-c">// Prevents issue with composedPath getting removed</span>
      <span class="pl-kos">(</span><span class="pl-s1">e</span> <span class="pl-k">as</span> <span class="pl-smi">any</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-c1">_savedComposedPath</span> <span class="pl-c1">=</span> <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-en">composedPath</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-s1">lastPointerEvent</span><span class="pl-kos">.</span><span class="pl-c1">current</span> <span class="pl-c1">=</span> <span class="pl-s1">e</span><span class="pl-kos">;</span>
      <span class="pl-en">setAllowUseComposer</span><span class="pl-kos">(</span><span class="pl-c1">true</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">;</span>

    <span class="pl-c">// Right click to cancel placing</span>
    <span class="pl-k">const</span> <span class="pl-en">handleContextMenu</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-s1">e</span>: <span class="pl-smi">Event</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">creatingCommentState</span> <span class="pl-c1">===</span> <span class="pl-s">"placing"</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
        <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-en">preventDefault</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
        <span class="pl-en">setCreatingCommentState</span><span class="pl-kos">(</span><span class="pl-s">"complete"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-kos">}</span>
    <span class="pl-kos">}</span><span class="pl-kos">;</span>

    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-s">"pointerdown"</span><span class="pl-kos">,</span> <span class="pl-s1">handlePointerDown</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-s">"contextmenu"</span><span class="pl-kos">,</span> <span class="pl-s1">handleContextMenu</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

    <span class="pl-k">return</span> <span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-en">removeEventListener</span><span class="pl-kos">(</span>
        <span class="pl-s">"pointerdown"</span><span class="pl-kos">,</span>
        <span class="pl-s1">handlePointerDown</span>
      <span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-en">removeEventListener</span><span class="pl-kos">(</span>
        <span class="pl-s">"contextmenu"</span><span class="pl-kos">,</span>
        <span class="pl-s1">handleContextMenu</span>
      <span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-kos">[</span><span class="pl-s1">creatingCommentState</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">// On composer submit, create thread and reset state</span>
  <span class="pl-k">const</span> <span class="pl-s1">handleComposerSubmit</span> <span class="pl-c1">=</span> <span class="pl-en">useCallback</span><span class="pl-kos">(</span>
    <span class="pl-kos">(</span><span class="pl-kos">{</span> body <span class="pl-kos">}</span>: <span class="pl-smi">ComposerSubmitComment</span><span class="pl-kos">,</span> <span class="pl-s1">event</span>: <span class="pl-smi">FormEvent</span><span class="pl-kos">&lt;</span><span class="pl-smi">HTMLFormElement</span><span class="pl-kos">&gt;</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-s1">event</span><span class="pl-kos">.</span><span class="pl-en">preventDefault</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-s1">event</span><span class="pl-kos">.</span><span class="pl-en">stopPropagation</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

      <span class="pl-c">// Get your canvas element</span>
      <span class="pl-k">const</span> <span class="pl-s1">overlayPanel</span> <span class="pl-c1">=</span> <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-en">querySelector</span><span class="pl-kos">(</span><span class="pl-s">"#canvas"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

      <span class="pl-c">// if there's no composer coords or last pointer event, meaning the user hasn't clicked yet, don't do anything</span>
      <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-c1">!</span><span class="pl-s1">composerCoords</span> <span class="pl-c1">||</span> <span class="pl-c1">!</span><span class="pl-s1">lastPointerEvent</span><span class="pl-kos">.</span><span class="pl-c1">current</span> <span class="pl-c1">||</span> <span class="pl-c1">!</span><span class="pl-s1">overlayPanel</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
        <span class="pl-k">return</span><span class="pl-kos">;</span>
      <span class="pl-kos">}</span>

      <span class="pl-c">// Set coords relative to the top left of your canvas</span>
      <span class="pl-k">const</span> <span class="pl-kos">{</span> top<span class="pl-kos">,</span> left <span class="pl-kos">}</span> <span class="pl-c1">=</span> <span class="pl-s1">overlayPanel</span><span class="pl-kos">.</span><span class="pl-en">getBoundingClientRect</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-k">const</span> <span class="pl-s1">x</span> <span class="pl-c1">=</span> <span class="pl-s1">composerCoords</span><span class="pl-kos">.</span><span class="pl-c1">x</span> <span class="pl-c1">-</span> <span class="pl-s1">left</span><span class="pl-kos">;</span>
      <span class="pl-k">const</span> <span class="pl-s1">y</span> <span class="pl-c1">=</span> <span class="pl-s1">composerCoords</span><span class="pl-kos">.</span><span class="pl-c1">y</span> <span class="pl-c1">-</span> <span class="pl-s1">top</span><span class="pl-kos">;</span>

      <span class="pl-c">// create a new thread with the composer coords and cursor selectors</span>
      <span class="pl-en">createThread</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
        body<span class="pl-kos">,</span>
        <span class="pl-c1">metadata</span>: <span class="pl-kos">{</span>
          x<span class="pl-kos">,</span>
          y<span class="pl-kos">,</span>
          <span class="pl-c1">resolved</span>: <span class="pl-c1">false</span><span class="pl-kos">,</span>
          <span class="pl-c1">zIndex</span>: <span class="pl-s1">maxZIndex</span> <span class="pl-c1">+</span> <span class="pl-c1">1</span><span class="pl-kos">,</span>
        <span class="pl-kos">}</span><span class="pl-kos">,</span>
      <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

      <span class="pl-en">setComposerCoords</span><span class="pl-kos">(</span><span class="pl-c1">null</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-en">setCreatingCommentState</span><span class="pl-kos">(</span><span class="pl-s">"complete"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-en">setAllowUseComposer</span><span class="pl-kos">(</span><span class="pl-c1">false</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">,</span>
    <span class="pl-kos">[</span><span class="pl-s1">createThread</span><span class="pl-kos">,</span> <span class="pl-s1">composerCoords</span><span class="pl-kos">,</span> <span class="pl-s1">maxZIndex</span><span class="pl-kos">]</span>
  <span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-k">return</span> <span class="pl-kos">(</span>
    <span class="pl-c1">&lt;</span><span class="pl-c1">&gt;</span>
      <span class="pl-kos">{</span><span class="pl-c">/**</span>
<span class="pl-c">       * Slot is used to wrap the children of the NewThread component</span>
<span class="pl-c">       * to allow us to add a click event listener to the children</span>
<span class="pl-c">       *</span>
<span class="pl-c">       * Slot: https://www.radix-ui.com/primitives/docs/utilities/slot</span>
<span class="pl-c">       *</span>
<span class="pl-c">       * Disclaimer: We don't have to download this package specifically,</span>
<span class="pl-c">       * it's already included when we install Shadcn</span>
<span class="pl-c">       */</span><span class="pl-kos">}</span>
      <span class="pl-c1">&lt;</span><span class="pl-smi">Slot</span>
        <span class="pl-c1">onClick</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span>
          <span class="pl-en">setCreatingCommentState</span><span class="pl-kos">(</span>
            <span class="pl-s1">creatingCommentState</span> <span class="pl-c1">!==</span> <span class="pl-s">"complete"</span> ? <span class="pl-s">"complete"</span> : <span class="pl-s">"placing"</span>
          <span class="pl-kos">)</span>
        <span class="pl-kos">}</span>
        <span class="pl-c1">style</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-kos">{</span> <span class="pl-c1">opacity</span>: <span class="pl-s1">creatingCommentState</span> <span class="pl-c1">!==</span> <span class="pl-s">"complete"</span> ? <span class="pl-c1">0.7</span> : <span class="pl-c1">1</span> <span class="pl-kos">}</span><span class="pl-kos">}</span>
      <span class="pl-c1">&gt;</span>
        <span class="pl-kos">{</span><span class="pl-s1">children</span><span class="pl-kos">}</span>
      <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-smi">Slot</span><span class="pl-c1">&gt;</span>

      <span class="pl-kos">{</span><span class="pl-c">/* if composer coords exist and we're placing a comment, render the composer */</span><span class="pl-kos">}</span>
      <span class="pl-kos">{</span><span class="pl-s1">composerCoords</span> <span class="pl-c1">&amp;&amp;</span> <span class="pl-s1">creatingCommentState</span> <span class="pl-c1">===</span> <span class="pl-s">"placed"</span> ? <span class="pl-kos">(</span>
        <span class="pl-c">/**</span>
<span class="pl-c">         * Portal.Root is used to render the composer outside of the NewThread component to avoid z-index issuess</span>
<span class="pl-c">         *</span>
<span class="pl-c">         * Portal.Root: https://www.radix-ui.com/primitives/docs/utilities/portal</span>
<span class="pl-c">         */</span>
        <span class="pl-c1">&lt;</span><span class="pl-smi">Portal</span><span class="pl-kos">.</span><span class="pl-smi">Root</span>
          <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">'absolute left-0 top-0'</span>
          <span class="pl-c1">style</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-kos">{</span>
            <span class="pl-c1">pointerEvents</span>: <span class="pl-s1">allowUseComposer</span> ? <span class="pl-s">"initial"</span> : <span class="pl-s">"none"</span><span class="pl-kos">,</span>
            <span class="pl-c1">transform</span>: <span class="pl-s">`translate(<span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">composerCoords</span><span class="pl-kos">.</span><span class="pl-c1">x</span><span class="pl-kos">}</span></span>px, <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">composerCoords</span><span class="pl-kos">.</span><span class="pl-c1">y</span><span class="pl-kos">}</span></span>px)`</span><span class="pl-kos">,</span>
          <span class="pl-kos">}</span><span class="pl-kos">}</span>
          <span class="pl-c1">data-hide-cursors</span>
        <span class="pl-c1">&gt;</span>
          <span class="pl-c1">&lt;</span><span class="pl-smi">PinnedComposer</span> <span class="pl-c1">onComposerSubmit</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">handleComposerSubmit</span><span class="pl-kos">}</span> <span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
        <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-smi">Portal</span><span class="pl-kos">.</span><span class="pl-smi">Root</span><span class="pl-c1">&gt;</span>
      <span class="pl-kos">)</span> : <span class="pl-c1">null</span><span class="pl-kos">}</span>

      <span class="pl-kos">{</span><span class="pl-c">/* Show the customizing cursor when placing a comment. The one with comment shape */</span><span class="pl-kos">}</span>
      <span class="pl-c1">&lt;</span><span class="pl-smi">NewThreadCursor</span> <span class="pl-c1">display</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">creatingCommentState</span> <span class="pl-c1">===</span> <span class="pl-s">"placing"</span><span class="pl-kos">}</span> <span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
    <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
  <span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="&quot;use client&quot;;

import {
  FormEvent,
  ReactNode,
  useCallback,
  useEffect,
  useRef,
  useState,
} from &quot;react&quot;;
import { Slot } from &quot;@radix-ui/react-slot&quot;;
import * as Portal from &quot;@radix-ui/react-portal&quot;;
import { ComposerSubmitComment } from &quot;@liveblocks/react-comments/primitives&quot;;

import { useCreateThread } from &quot;@/liveblocks.config&quot;;
import { useMaxZIndex } from &quot;@/lib/useMaxZIndex&quot;;

import PinnedComposer from &quot;./PinnedComposer&quot;;
import NewThreadCursor from &quot;./NewThreadCursor&quot;;

type ComposerCoords = null | { x: number; y: number };

type Props = {
  children: ReactNode;
};

export const NewThread = ({ children }: Props) => {
  // set state to track if we're placing a new comment or not
  const [creatingCommentState, setCreatingCommentState] = useState<
    &quot;placing&quot; | &quot;placed&quot; | &quot;complete&quot;
  >(&quot;complete&quot;);

  /**
   * We're using the useCreateThread hook to create a new thread.
   *
   * useCreateThread: https://liveblocks.io/docs/api-reference/liveblocks-react#useCreateThread
   */
  const createThread = useCreateThread();

  // get the max z-index of a thread
  const maxZIndex = useMaxZIndex();

  // set state to track the coordinates of the composer (liveblocks comment editor)
  const [composerCoords, setComposerCoords] = useState<ComposerCoords>(null);

  // set state to track the last pointer event
  const lastPointerEvent = useRef<PointerEvent>();

  // set state to track if user is allowed to use the composer
  const [allowUseComposer, setAllowUseComposer] = useState(false);
  const allowComposerRef = useRef(allowUseComposer);
  allowComposerRef.current = allowUseComposer;

  useEffect(() => {
    // If composer is already placed, don't do anything
    if (creatingCommentState === &quot;complete&quot;) {
      return;
    }

    // Place a composer on the screen
    const newComment = (e: MouseEvent) => {
      e.preventDefault();

      // If already placed, click outside to close composer
      if (creatingCommentState === &quot;placed&quot;) {
        // check if the click event is on/inside the composer
        const isClickOnComposer = ((e as any)._savedComposedPath = e
          .composedPath()
          .some((el: any) => {
            return el.classList?.contains(&quot;lb-composer-editor-actions&quot;);
          }));

        // if click is inisde/on composer, don't do anything
        if (isClickOnComposer) {
          return;
        }

        // if click is outside composer, close composer
        if (!isClickOnComposer) {
          setCreatingCommentState(&quot;complete&quot;);
          return;
        }
      }

      // First click sets composer down
      setCreatingCommentState(&quot;placed&quot;);
      setComposerCoords({
        x: e.clientX,
        y: e.clientY,
      });
    };

    document.documentElement.addEventListener(&quot;click&quot;, newComment);

    return () => {
      document.documentElement.removeEventListener(&quot;click&quot;, newComment);
    };
  }, [creatingCommentState]);

  useEffect(() => {
    // If dragging composer, update position
    const handlePointerMove = (e: PointerEvent) => {
      // Prevents issue with composedPath getting removed
      (e as any)._savedComposedPath = e.composedPath();
      lastPointerEvent.current = e;
    };

    document.documentElement.addEventListener(&quot;pointermove&quot;, handlePointerMove);

    return () => {
      document.documentElement.removeEventListener(
        &quot;pointermove&quot;,
        handlePointerMove
      );
    };
  }, []);

  // Set pointer event from last click on body for use later
  useEffect(() => {
    if (creatingCommentState !== &quot;placing&quot;) {
      return;
    }

    const handlePointerDown = (e: PointerEvent) => {
      // if composer is already placed, don't do anything
      if (allowComposerRef.current) {
        return;
      }

      // Prevents issue with composedPath getting removed
      (e as any)._savedComposedPath = e.composedPath();
      lastPointerEvent.current = e;
      setAllowUseComposer(true);
    };

    // Right click to cancel placing
    const handleContextMenu = (e: Event) => {
      if (creatingCommentState === &quot;placing&quot;) {
        e.preventDefault();
        setCreatingCommentState(&quot;complete&quot;);
      }
    };

    document.documentElement.addEventListener(&quot;pointerdown&quot;, handlePointerDown);
    document.documentElement.addEventListener(&quot;contextmenu&quot;, handleContextMenu);

    return () => {
      document.documentElement.removeEventListener(
        &quot;pointerdown&quot;,
        handlePointerDown
      );
      document.documentElement.removeEventListener(
        &quot;contextmenu&quot;,
        handleContextMenu
      );
    };
  }, [creatingCommentState]);

  // On composer submit, create thread and reset state
  const handleComposerSubmit = useCallback(
    ({ body }: ComposerSubmitComment, event: FormEvent<HTMLFormElement>) => {
      event.preventDefault();
      event.stopPropagation();

      // Get your canvas element
      const overlayPanel = document.querySelector(&quot;#canvas&quot;);

      // if there's no composer coords or last pointer event, meaning the user hasn't clicked yet, don't do anything
      if (!composerCoords || !lastPointerEvent.current || !overlayPanel) {
        return;
      }

      // Set coords relative to the top left of your canvas
      const { top, left } = overlayPanel.getBoundingClientRect();
      const x = composerCoords.x - left;
      const y = composerCoords.y - top;

      // create a new thread with the composer coords and cursor selectors
      createThread({
        body,
        metadata: {
          x,
          y,
          resolved: false,
          zIndex: maxZIndex + 1,
        },
      });

      setComposerCoords(null);
      setCreatingCommentState(&quot;complete&quot;);
      setAllowUseComposer(false);
    },
    [createThread, composerCoords, maxZIndex]
  );

  return (
    <>
      {/**
       * Slot is used to wrap the children of the NewThread component
       * to allow us to add a click event listener to the children
       *
       * Slot: https://www.radix-ui.com/primitives/docs/utilities/slot
       *
       * Disclaimer: We don't have to download this package specifically,
       * it's already included when we install Shadcn
       */}
      <Slot
        onClick={() =>
          setCreatingCommentState(
            creatingCommentState !== &quot;complete&quot; ? &quot;complete&quot; : &quot;placing&quot;
          )
        }
        style={{ opacity: creatingCommentState !== &quot;complete&quot; ? 0.7 : 1 }}
      >
        {children}
      </Slot>

      {/* if composer coords exist and we're placing a comment, render the composer */}
      {composerCoords &amp;&amp; creatingCommentState === &quot;placed&quot; ? (
        /**
         * Portal.Root is used to render the composer outside of the NewThread component to avoid z-index issuess
         *
         * Portal.Root: https://www.radix-ui.com/primitives/docs/utilities/portal
         */
        <Portal.Root
          className='absolute left-0 top-0'
          style={{
            pointerEvents: allowUseComposer ? &quot;initial&quot; : &quot;none&quot;,
            transform: `translate(${composerCoords.x}px, ${composerCoords.y}px)`,
          }}
          data-hide-cursors
        >
          <PinnedComposer onComposerSubmit={handleComposerSubmit} />
        </Portal.Root>
      ) : null}

      {/* Show the customizing cursor when placing a comment. The one with comment shape */}
      <NewThreadCursor display={creatingCommentState === &quot;placing&quot;} />
    </>
  );
};" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<details>
<summary><code>PinnedComposer</code></summary>
<div class="highlight highlight-source-tsx notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s">"use client"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-smi">Image</span> <span class="pl-k">from</span> <span class="pl-s">"next/image"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">Composer</span><span class="pl-kos">,</span> <span class="pl-smi">ComposerProps</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@liveblocks/react-comments"</span><span class="pl-kos">;</span>

<span class="pl-k">type</span> <span class="pl-smi">Props</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
  <span class="pl-c1">onComposerSubmit</span>: <span class="pl-smi">ComposerProps</span><span class="pl-kos">[</span><span class="pl-s">"onComposerSubmit"</span><span class="pl-kos">]</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-smi">PinnedComposer</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-kos">{</span> onComposerSubmit<span class="pl-kos">,</span> ...<span class="pl-s1">props</span> <span class="pl-kos">}</span>: <span class="pl-smi">Props</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-k">return</span> <span class="pl-kos">(</span>
    <span class="pl-c1">&lt;</span><span class="pl-ent">div</span> <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">"absolute flex gap-4"</span> <span class="pl-kos">{</span>...<span class="pl-s1">props</span><span class="pl-kos">}</span><span class="pl-c1">&gt;</span>
      <span class="pl-c1">&lt;</span><span class="pl-ent">div</span> <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">"select-none relative w-9 h-9 shadow rounded-tl-md rounded-tr-full rounded-br-full rounded-bl-full bg-white flex justify-center items-center"</span><span class="pl-c1">&gt;</span>
        <span class="pl-c1">&lt;</span><span class="pl-smi">Image</span>
          <span class="pl-c1">src</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s">`https://liveblocks.io/avatars/avatar-<span class="pl-s1"><span class="pl-kos">${</span><span class="pl-smi">Math</span><span class="pl-kos">.</span><span class="pl-en">floor</span><span class="pl-kos">(</span><span class="pl-smi">Math</span><span class="pl-kos">.</span><span class="pl-en">random</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">*</span> <span class="pl-c1">30</span><span class="pl-kos">)</span><span class="pl-kos">}</span></span>.png`</span><span class="pl-kos">}</span>
          <span class="pl-c1">alt</span><span class="pl-c1">=</span><span class="pl-s">"someone"</span>
          <span class="pl-c1">width</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-c1">28</span><span class="pl-kos">}</span>
          <span class="pl-c1">height</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-c1">28</span><span class="pl-kos">}</span>
          <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">"rounded-full"</span>
        <span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
      <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">div</span><span class="pl-c1">&gt;</span>
      <span class="pl-c1">&lt;</span><span class="pl-ent">div</span> <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">"shadow bg-white rounded-lg flex flex-col text-sm min-w-96 overflow-hidden p-2"</span><span class="pl-c1">&gt;</span>
        <span class="pl-kos">{</span><span class="pl-c">/**</span>
<span class="pl-c">         * We're using the Composer component to create a new comment.</span>
<span class="pl-c">         * Liveblocks provides a Composer component that allows to</span>
<span class="pl-c">         * create/edit/delete comments.</span>
<span class="pl-c">         *</span>
<span class="pl-c">         * Composer: https://liveblocks.io/docs/api-reference/liveblocks-react-comments#Composer</span>
<span class="pl-c">         */</span><span class="pl-kos">}</span>
        <span class="pl-c1">&lt;</span><span class="pl-smi">Composer</span>
          <span class="pl-c1">onComposerSubmit</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">onComposerSubmit</span><span class="pl-kos">}</span>
          <span class="pl-c1">autoFocus</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-c1">true</span><span class="pl-kos">}</span>
          <span class="pl-c1">onKeyUp</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-kos">(</span><span class="pl-s1">e</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
            <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-en">stopPropagation</span><span class="pl-kos">(</span><span class="pl-kos">)</span>
          <span class="pl-kos">}</span><span class="pl-kos">}</span>
        <span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
      <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">div</span><span class="pl-c1">&gt;</span>
    <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">div</span><span class="pl-c1">&gt;</span>
  <span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">export</span> <span class="pl-k">default</span> <span class="pl-smi">PinnedComposer</span><span class="pl-kos">;</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="&quot;use client&quot;;

import Image from &quot;next/image&quot;;
import { Composer, ComposerProps } from &quot;@liveblocks/react-comments&quot;;

type Props = {
  onComposerSubmit: ComposerProps[&quot;onComposerSubmit&quot;];
};

const PinnedComposer = ({ onComposerSubmit, ...props }: Props) => {
  return (
    <div className=&quot;absolute flex gap-4&quot; {...props}>
      <div className=&quot;select-none relative w-9 h-9 shadow rounded-tl-md rounded-tr-full rounded-br-full rounded-bl-full bg-white flex justify-center items-center&quot;>
        <Image
          src={`https://liveblocks.io/avatars/avatar-${Math.floor(Math.random() * 30)}.png`}
          alt=&quot;someone&quot;
          width={28}
          height={28}
          className=&quot;rounded-full&quot;
        />
      </div>
      <div className=&quot;shadow bg-white rounded-lg flex flex-col text-sm min-w-96 overflow-hidden p-2&quot;>
        {/**
         * We're using the Composer component to create a new comment.
         * Liveblocks provides a Composer component that allows to
         * create/edit/delete comments.
         *
         * Composer: https://liveblocks.io/docs/api-reference/liveblocks-react-comments#Composer
         */}
        <Composer
          onComposerSubmit={onComposerSubmit}
          autoFocus={true}
          onKeyUp={(e) => {
            e.stopPropagation()
          }}
        />
      </div>
    </div>
  );
};

export default PinnedComposer;" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<details>
<summary><code>NewThreadCursor</code></summary>
<div class="highlight highlight-source-tsx notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s">"use client"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">useEffect</span><span class="pl-kos">,</span> <span class="pl-s1">useState</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"react"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-c1">*</span> <span class="pl-k">as</span> <span class="pl-smi">Portal</span> <span class="pl-k">from</span> <span class="pl-s">"@radix-ui/react-portal"</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-smi">DEFAULT_CURSOR_POSITION</span> <span class="pl-c1">=</span> <span class="pl-c1">-</span><span class="pl-c1">10000</span><span class="pl-kos">;</span>

<span class="pl-c">// display a custom cursor when placing a new thread</span>
<span class="pl-k">const</span> <span class="pl-smi">NewThreadCursor</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-kos">{</span> display <span class="pl-kos">}</span>: <span class="pl-kos">{</span> <span class="pl-c1">display</span>: <span class="pl-smi">boolean</span> <span class="pl-kos">}</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-k">const</span> <span class="pl-kos">[</span><span class="pl-s1">coords</span><span class="pl-kos">,</span> <span class="pl-s1">setCoords</span><span class="pl-kos">]</span> <span class="pl-c1">=</span> <span class="pl-en">useState</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
    <span class="pl-c1">x</span>: <span class="pl-smi">DEFAULT_CURSOR_POSITION</span><span class="pl-kos">,</span>
    <span class="pl-c1">y</span>: <span class="pl-smi">DEFAULT_CURSOR_POSITION</span><span class="pl-kos">,</span>
  <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-en">useEffect</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">const</span> <span class="pl-en">updatePosition</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-s1">e</span>: <span class="pl-smi">MouseEvent</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-c">// get canvas element</span>
      <span class="pl-k">const</span> <span class="pl-s1">canvas</span> <span class="pl-c1">=</span> <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-en">getElementById</span><span class="pl-kos">(</span><span class="pl-s">"canvas"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

      <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">canvas</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
        <span class="pl-c">/**</span>
<span class="pl-c">         * getBoundingClientRect returns the size of an element and its position relative to the viewport</span>
<span class="pl-c">         *</span>
<span class="pl-c">         * getBoundingClientRect: https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect</span>
<span class="pl-c">         */</span>
        <span class="pl-k">const</span> <span class="pl-s1">canvasRect</span> <span class="pl-c1">=</span> <span class="pl-s1">canvas</span><span class="pl-kos">.</span><span class="pl-en">getBoundingClientRect</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

        <span class="pl-c">// check if the mouse is outside the canvas</span>
        <span class="pl-c">// if so, hide the custom comment cursor</span>
        <span class="pl-k">if</span> <span class="pl-kos">(</span>
          <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">clientX</span> <span class="pl-c1">&lt;</span> <span class="pl-s1">canvasRect</span><span class="pl-kos">.</span><span class="pl-c1">left</span> <span class="pl-c1">||</span>
          <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">clientX</span> <span class="pl-c1">&gt;</span> <span class="pl-s1">canvasRect</span><span class="pl-kos">.</span><span class="pl-c1">right</span> <span class="pl-c1">||</span>
          <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">clientY</span> <span class="pl-c1">&lt;</span> <span class="pl-s1">canvasRect</span><span class="pl-kos">.</span><span class="pl-c1">top</span> <span class="pl-c1">||</span>
          <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">clientY</span> <span class="pl-c1">&gt;</span> <span class="pl-s1">canvasRect</span><span class="pl-kos">.</span><span class="pl-c1">bottom</span>
        <span class="pl-kos">)</span> <span class="pl-kos">{</span>
          <span class="pl-en">setCoords</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
            <span class="pl-c1">x</span>: <span class="pl-smi">DEFAULT_CURSOR_POSITION</span><span class="pl-kos">,</span>
            <span class="pl-c1">y</span>: <span class="pl-smi">DEFAULT_CURSOR_POSITION</span><span class="pl-kos">,</span>
          <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
          <span class="pl-k">return</span><span class="pl-kos">;</span>
        <span class="pl-kos">}</span>
      <span class="pl-kos">}</span>

      <span class="pl-c">// set the coordinates of the cursor</span>
      <span class="pl-en">setCoords</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
        <span class="pl-c1">x</span>: <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">clientX</span><span class="pl-kos">,</span>
        <span class="pl-c1">y</span>: <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">clientY</span><span class="pl-kos">,</span>
      <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">;</span>

    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-s">"mousemove"</span><span class="pl-kos">,</span> <span class="pl-s1">updatePosition</span><span class="pl-kos">,</span> <span class="pl-c1">false</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-en">addEventListener</span><span class="pl-kos">(</span><span class="pl-s">"mouseenter"</span><span class="pl-kos">,</span> <span class="pl-s1">updatePosition</span><span class="pl-kos">,</span> <span class="pl-c1">false</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

    <span class="pl-k">return</span> <span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-en">removeEventListener</span><span class="pl-kos">(</span><span class="pl-s">"mousemove"</span><span class="pl-kos">,</span> <span class="pl-s1">updatePosition</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-en">removeEventListener</span><span class="pl-kos">(</span><span class="pl-s">"mouseenter"</span><span class="pl-kos">,</span> <span class="pl-s1">updatePosition</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-kos">[</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-en">useEffect</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">display</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-c1">classList</span><span class="pl-kos">.</span><span class="pl-en">add</span><span class="pl-kos">(</span><span class="pl-s">"hide-cursor"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span> <span class="pl-k">else</span> <span class="pl-kos">{</span>
      <span class="pl-smi">document</span><span class="pl-kos">.</span><span class="pl-c1">documentElement</span><span class="pl-kos">.</span><span class="pl-c1">classList</span><span class="pl-kos">.</span><span class="pl-en">remove</span><span class="pl-kos">(</span><span class="pl-s">"hide-cursor"</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-kos">[</span><span class="pl-s1">display</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-c1">!</span><span class="pl-s1">display</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-k">return</span> <span class="pl-c1">null</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span>

  <span class="pl-k">return</span> <span class="pl-kos">(</span>
    <span class="pl-c">// Portal.Root is used to render a component outside of its parent component</span>
    <span class="pl-c1">&lt;</span><span class="pl-smi">Portal</span><span class="pl-kos">.</span><span class="pl-smi">Root</span><span class="pl-c1">&gt;</span>
      <span class="pl-c1">&lt;</span><span class="pl-ent">div</span>
        <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">"pointer-events-none fixed left-0 top-0 h-9 w-9 cursor-grab select-none rounded-bl-full rounded-br-full rounded-tl-md rounded-tr-full bg-white shadow-2xl"</span>
        <span class="pl-c1">style</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-kos">{</span>
          <span class="pl-c1">transform</span>: <span class="pl-s">`translate(<span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">coords</span><span class="pl-kos">.</span><span class="pl-c1">x</span><span class="pl-kos">}</span></span>px, <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">coords</span><span class="pl-kos">.</span><span class="pl-c1">y</span><span class="pl-kos">}</span></span>px)`</span><span class="pl-kos">,</span>
        <span class="pl-kos">}</span><span class="pl-kos">}</span>
      <span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
    <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-smi">Portal</span><span class="pl-kos">.</span><span class="pl-smi">Root</span><span class="pl-c1">&gt;</span>
  <span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">export</span> <span class="pl-k">default</span> <span class="pl-smi">NewThreadCursor</span><span class="pl-kos">;</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="&quot;use client&quot;;

import { useEffect, useState } from &quot;react&quot;;
import * as Portal from &quot;@radix-ui/react-portal&quot;;

const DEFAULT_CURSOR_POSITION = -10000;

// display a custom cursor when placing a new thread
const NewThreadCursor = ({ display }: { display: boolean }) => {
  const [coords, setCoords] = useState({
    x: DEFAULT_CURSOR_POSITION,
    y: DEFAULT_CURSOR_POSITION,
  });

  useEffect(() => {
    const updatePosition = (e: MouseEvent) => {
      // get canvas element
      const canvas = document.getElementById(&quot;canvas&quot;);

      if (canvas) {
        /**
         * getBoundingClientRect returns the size of an element and its position relative to the viewport
         *
         * getBoundingClientRect: https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect
         */
        const canvasRect = canvas.getBoundingClientRect();

        // check if the mouse is outside the canvas
        // if so, hide the custom comment cursor
        if (
          e.clientX < canvasRect.left ||
          e.clientX > canvasRect.right ||
          e.clientY < canvasRect.top ||
          e.clientY > canvasRect.bottom
        ) {
          setCoords({
            x: DEFAULT_CURSOR_POSITION,
            y: DEFAULT_CURSOR_POSITION,
          });
          return;
        }
      }

      // set the coordinates of the cursor
      setCoords({
        x: e.clientX,
        y: e.clientY,
      });
    };

    document.addEventListener(&quot;mousemove&quot;, updatePosition, false);
    document.addEventListener(&quot;mouseenter&quot;, updatePosition, false);

    return () => {
      document.removeEventListener(&quot;mousemove&quot;, updatePosition);
      document.removeEventListener(&quot;mouseenter&quot;, updatePosition);
    };
  }, []);

  useEffect(() => {
    if (display) {
      document.documentElement.classList.add(&quot;hide-cursor&quot;);
    } else {
      document.documentElement.classList.remove(&quot;hide-cursor&quot;);
    }
  }, [display]);

  if (!display) {
    return null;
  }

  return (
    // Portal.Root is used to render a component outside of its parent component
    <Portal.Root>
      <div
        className=&quot;pointer-events-none fixed left-0 top-0 h-9 w-9 cursor-grab select-none rounded-bl-full rounded-br-full rounded-tl-md rounded-tr-full bg-white shadow-2xl&quot;
        style={{
          transform: `translate(${coords.x}px, ${coords.y}px)`,
        }}
      />
    </Portal.Root>
  );
};

export default NewThreadCursor;" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<details>
<summary><code>CommentsOverlay</code></summary>
<div class="highlight highlight-source-tsx notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s">"use client"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">useCallback</span><span class="pl-kos">,</span> <span class="pl-s1">useRef</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"react"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">ThreadData</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@liveblocks/client"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">ThreadMetadata</span><span class="pl-kos">,</span> <span class="pl-s1">useEditThreadMetadata</span><span class="pl-kos">,</span> <span class="pl-s1">useThreads</span><span class="pl-kos">,</span> <span class="pl-s1">useUser</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@/liveblocks.config"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">useMaxZIndex</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@/lib/useMaxZIndex"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">PinnedThread</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"./PinnedThread"</span><span class="pl-kos">;</span>

<span class="pl-k">type</span> <span class="pl-smi">OverlayThreadProps</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
  <span class="pl-c1">thread</span>: <span class="pl-smi">ThreadData</span><span class="pl-kos">&lt;</span><span class="pl-smi">ThreadMetadata</span><span class="pl-kos">&gt;</span><span class="pl-kos">;</span>
  <span class="pl-c1">maxZIndex</span>: <span class="pl-smi">number</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">export</span> <span class="pl-k">const</span> <span class="pl-smi">CommentsOverlay</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-c">/**</span>
<span class="pl-c">   * We're using the useThreads hook to get the list of threads</span>
<span class="pl-c">   * in the room.</span>
<span class="pl-c">   *</span>
<span class="pl-c">   * useThreads: https://liveblocks.io/docs/api-reference/liveblocks-react#useThreads</span>
<span class="pl-c">   */</span>
  <span class="pl-k">const</span> <span class="pl-kos">{</span> threads <span class="pl-kos">}</span> <span class="pl-c1">=</span> <span class="pl-en">useThreads</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">// get the max z-index of a thread</span>
  <span class="pl-k">const</span> <span class="pl-s1">maxZIndex</span> <span class="pl-c1">=</span> <span class="pl-en">useMaxZIndex</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-k">return</span> <span class="pl-kos">(</span>
    <span class="pl-c1">&lt;</span><span class="pl-ent">div</span><span class="pl-c1">&gt;</span>
      <span class="pl-kos">{</span><span class="pl-s1">threads</span>
        <span class="pl-kos">.</span><span class="pl-en">filter</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-s1">thread</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-c1">!</span><span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">metadata</span><span class="pl-kos">.</span><span class="pl-c1">resolved</span><span class="pl-kos">)</span>
        <span class="pl-kos">.</span><span class="pl-en">map</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-s1">thread</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">(</span>
          <span class="pl-c1">&lt;</span><span class="pl-smi">OverlayThread</span> <span class="pl-c1">key</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">id</span><span class="pl-kos">}</span> <span class="pl-c1">thread</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">thread</span><span class="pl-kos">}</span> <span class="pl-c1">maxZIndex</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">maxZIndex</span><span class="pl-kos">}</span> <span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
        <span class="pl-kos">)</span><span class="pl-kos">)</span><span class="pl-kos">}</span>
    <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">div</span><span class="pl-c1">&gt;</span>
  <span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">const</span> <span class="pl-smi">OverlayThread</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-kos">{</span> thread<span class="pl-kos">,</span> maxZIndex <span class="pl-kos">}</span>: <span class="pl-smi">OverlayThreadProps</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-c">/**</span>
<span class="pl-c">   * We're using the useEditThreadMetadata hook to edit the metadata</span>
<span class="pl-c">   * of a thread.</span>
<span class="pl-c">   *</span>
<span class="pl-c">   * useEditThreadMetadata: https://liveblocks.io/docs/api-reference/liveblocks-react#useEditThreadMetadata</span>
<span class="pl-c">   */</span>
  <span class="pl-k">const</span> <span class="pl-s1">editThreadMetadata</span> <span class="pl-c1">=</span> <span class="pl-en">useEditThreadMetadata</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">/**</span>
<span class="pl-c">   * We're using the useUser hook to get the user of the thread.</span>
<span class="pl-c">   *</span>
<span class="pl-c">   * useUser: https://liveblocks.io/docs/api-reference/liveblocks-react#useUser</span>
<span class="pl-c">   */</span>
  <span class="pl-k">const</span> <span class="pl-kos">{</span> isLoading <span class="pl-kos">}</span> <span class="pl-c1">=</span> <span class="pl-en">useUser</span><span class="pl-kos">(</span><span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">comments</span><span class="pl-kos">[</span><span class="pl-c1">0</span><span class="pl-kos">]</span><span class="pl-kos">.</span><span class="pl-c1">userId</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">// We're using a ref to get the thread element to position it</span>
  <span class="pl-k">const</span> <span class="pl-s1">threadRef</span> <span class="pl-c1">=</span> <span class="pl-en">useRef</span><span class="pl-kos">&lt;</span><span class="pl-smi">HTMLDivElement</span><span class="pl-kos">&gt;</span><span class="pl-kos">(</span><span class="pl-c1">null</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">// If other thread(s) above, increase z-index on last element updated</span>
  <span class="pl-k">const</span> <span class="pl-s1">handleIncreaseZIndex</span> <span class="pl-c1">=</span> <span class="pl-en">useCallback</span><span class="pl-kos">(</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
    <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">maxZIndex</span> <span class="pl-c1">===</span> <span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">metadata</span><span class="pl-kos">.</span><span class="pl-c1">zIndex</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
      <span class="pl-k">return</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>

    <span class="pl-c">// Update the z-index of the thread in the room</span>
    <span class="pl-en">editThreadMetadata</span><span class="pl-kos">(</span><span class="pl-kos">{</span>
      <span class="pl-c1">threadId</span>: <span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">id</span><span class="pl-kos">,</span>
      <span class="pl-c1">metadata</span>: <span class="pl-kos">{</span>
        <span class="pl-c1">zIndex</span>: <span class="pl-s1">maxZIndex</span> <span class="pl-c1">+</span> <span class="pl-c1">1</span><span class="pl-kos">,</span>
      <span class="pl-kos">}</span><span class="pl-kos">,</span>
    <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span><span class="pl-kos">,</span> <span class="pl-kos">[</span><span class="pl-s1">thread</span><span class="pl-kos">,</span> <span class="pl-s1">editThreadMetadata</span><span class="pl-kos">,</span> <span class="pl-s1">maxZIndex</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-k">if</span> <span class="pl-kos">(</span><span class="pl-s1">isLoading</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-k">return</span> <span class="pl-c1">null</span><span class="pl-kos">;</span>
  <span class="pl-kos">}</span>

  <span class="pl-k">return</span> <span class="pl-kos">(</span>
    <span class="pl-c1">&lt;</span><span class="pl-ent">div</span>
      <span class="pl-c1">ref</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">threadRef</span><span class="pl-kos">}</span>
      <span class="pl-c1">id</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s">`thread-<span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">id</span><span class="pl-kos">}</span></span>`</span><span class="pl-kos">}</span>
      <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">"absolute left-0 top-0 flex gap-5"</span>
      <span class="pl-c1">style</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-kos">{</span>
        <span class="pl-c1">transform</span>: <span class="pl-s">`translate(<span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">metadata</span><span class="pl-kos">.</span><span class="pl-c1">x</span><span class="pl-kos">}</span></span>px, <span class="pl-s1"><span class="pl-kos">${</span><span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">metadata</span><span class="pl-kos">.</span><span class="pl-c1">y</span><span class="pl-kos">}</span></span>px)`</span><span class="pl-kos">,</span>
      <span class="pl-kos">}</span><span class="pl-kos">}</span>
    <span class="pl-c1">&gt;</span>
      <span class="pl-kos">{</span><span class="pl-c">/* render the thread */</span><span class="pl-kos">}</span>
      <span class="pl-c1">&lt;</span><span class="pl-smi">PinnedThread</span> <span class="pl-c1">thread</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">thread</span><span class="pl-kos">}</span> <span class="pl-c1">onFocus</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">handleIncreaseZIndex</span><span class="pl-kos">}</span> <span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
    <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">div</span><span class="pl-c1">&gt;</span>
  <span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="&quot;use client&quot;;

import { useCallback, useRef } from &quot;react&quot;;
import { ThreadData } from &quot;@liveblocks/client&quot;;

import { ThreadMetadata, useEditThreadMetadata, useThreads, useUser } from &quot;@/liveblocks.config&quot;;
import { useMaxZIndex } from &quot;@/lib/useMaxZIndex&quot;;

import { PinnedThread } from &quot;./PinnedThread&quot;;

type OverlayThreadProps = {
  thread: ThreadData<ThreadMetadata>;
  maxZIndex: number;
};

export const CommentsOverlay = () => {
  /**
   * We're using the useThreads hook to get the list of threads
   * in the room.
   *
   * useThreads: https://liveblocks.io/docs/api-reference/liveblocks-react#useThreads
   */
  const { threads } = useThreads();

  // get the max z-index of a thread
  const maxZIndex = useMaxZIndex();

  return (
    <div>
      {threads
        .filter((thread) => !thread.metadata.resolved)
        .map((thread) => (
          <OverlayThread key={thread.id} thread={thread} maxZIndex={maxZIndex} />
        ))}
    </div>
  );
};

const OverlayThread = ({ thread, maxZIndex }: OverlayThreadProps) => {
  /**
   * We're using the useEditThreadMetadata hook to edit the metadata
   * of a thread.
   *
   * useEditThreadMetadata: https://liveblocks.io/docs/api-reference/liveblocks-react#useEditThreadMetadata
   */
  const editThreadMetadata = useEditThreadMetadata();

  /**
   * We're using the useUser hook to get the user of the thread.
   *
   * useUser: https://liveblocks.io/docs/api-reference/liveblocks-react#useUser
   */
  const { isLoading } = useUser(thread.comments[0].userId);

  // We're using a ref to get the thread element to position it
  const threadRef = useRef<HTMLDivElement>(null);

  // If other thread(s) above, increase z-index on last element updated
  const handleIncreaseZIndex = useCallback(() => {
    if (maxZIndex === thread.metadata.zIndex) {
      return;
    }

    // Update the z-index of the thread in the room
    editThreadMetadata({
      threadId: thread.id,
      metadata: {
        zIndex: maxZIndex + 1,
      },
    });
  }, [thread, editThreadMetadata, maxZIndex]);

  if (isLoading) {
    return null;
  }

  return (
    <div
      ref={threadRef}
      id={`thread-${thread.id}`}
      className=&quot;absolute left-0 top-0 flex gap-5&quot;
      style={{
        transform: `translate(${thread.metadata.x}px, ${thread.metadata.y}px)`,
      }}
    >
      {/* render the thread */}
      <PinnedThread thread={thread} onFocus={handleIncreaseZIndex} />
    </div>
  );
};" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<details>
<summary><code>PinnedThread</code></summary>
<div class="highlight highlight-source-tsx notranslate position-relative overflow-auto" dir="auto"><pre><span class="pl-s">"use client"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-smi">Image</span> <span class="pl-k">from</span> <span class="pl-s">"next/image"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-s1">useMemo</span><span class="pl-kos">,</span> <span class="pl-s1">useState</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"react"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">ThreadData</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@liveblocks/client"</span><span class="pl-kos">;</span>
<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">Thread</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@liveblocks/react-comments"</span><span class="pl-kos">;</span>

<span class="pl-k">import</span> <span class="pl-kos">{</span> <span class="pl-smi">ThreadMetadata</span> <span class="pl-kos">}</span> <span class="pl-k">from</span> <span class="pl-s">"@/liveblocks.config"</span><span class="pl-kos">;</span>

<span class="pl-k">type</span> <span class="pl-smi">Props</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
  <span class="pl-c1">thread</span>: <span class="pl-smi">ThreadData</span><span class="pl-kos">&lt;</span><span class="pl-smi">ThreadMetadata</span><span class="pl-kos">&gt;</span><span class="pl-kos">;</span>
  <span class="pl-c1">onFocus</span>: <span class="pl-kos">(</span><span class="pl-s1">threadId</span>: <span class="pl-smi">string</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-smi"><span class="pl-k">void</span></span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span>

<span class="pl-k">export</span> <span class="pl-k">const</span> <span class="pl-smi">PinnedThread</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-kos">{</span> thread<span class="pl-kos">,</span> onFocus<span class="pl-kos">,</span> ...<span class="pl-s1">props</span> <span class="pl-kos">}</span>: <span class="pl-smi">Props</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
  <span class="pl-c">// Open pinned threads that have just been created</span>
  <span class="pl-k">const</span> <span class="pl-s1">startMinimized</span> <span class="pl-c1">=</span> <span class="pl-en">useMemo</span><span class="pl-kos">(</span>
    <span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-smi">Number</span><span class="pl-kos">(</span><span class="pl-k">new</span> <span class="pl-smi">Date</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">)</span> <span class="pl-c1">-</span> <span class="pl-smi">Number</span><span class="pl-kos">(</span><span class="pl-k">new</span> <span class="pl-smi">Date</span><span class="pl-kos">(</span><span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">createdAt</span><span class="pl-kos">)</span><span class="pl-kos">)</span> <span class="pl-c1">&gt;</span> <span class="pl-c1">100</span><span class="pl-kos">,</span>
    <span class="pl-kos">[</span><span class="pl-s1">thread</span><span class="pl-kos">]</span>
  <span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-k">const</span> <span class="pl-kos">[</span><span class="pl-s1">minimized</span><span class="pl-kos">,</span> <span class="pl-s1">setMinimized</span><span class="pl-kos">]</span> <span class="pl-c1">=</span> <span class="pl-en">useState</span><span class="pl-kos">(</span><span class="pl-s1">startMinimized</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-c">/**</span>
<span class="pl-c">   * memoize the result of this function so that it doesn't change on every render but only when the thread changes</span>
<span class="pl-c">   * Memo is used to optimize performance and avoid unnecessary re-renders.</span>
<span class="pl-c">   *</span>
<span class="pl-c">   * useMemo: https://react.dev/reference/react/useMemo</span>
<span class="pl-c">   */</span>

  <span class="pl-k">const</span> <span class="pl-s1">memoizedContent</span> <span class="pl-c1">=</span> <span class="pl-en">useMemo</span><span class="pl-kos">(</span>
    <span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">(</span>
      <span class="pl-c1">&lt;</span><span class="pl-ent">div</span>
        <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">'absolute flex cursor-pointer gap-4'</span>
        <span class="pl-kos">{</span>...<span class="pl-s1">props</span><span class="pl-kos">}</span>
        <span class="pl-c1">onClick</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-kos">(</span><span class="pl-s1">e</span>: <span class="pl-smi">any</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
          <span class="pl-en">onFocus</span><span class="pl-kos">(</span><span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">id</span><span class="pl-kos">)</span><span class="pl-kos">;</span>

          <span class="pl-c">// check if click is on/in the composer</span>
          <span class="pl-k">if</span> <span class="pl-kos">(</span>
            <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">target</span> <span class="pl-c1">&amp;&amp;</span>
            <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">target</span><span class="pl-kos">.</span><span class="pl-c1">classList</span><span class="pl-kos">.</span><span class="pl-en">contains</span><span class="pl-kos">(</span><span class="pl-s">"lb-icon"</span><span class="pl-kos">)</span> <span class="pl-c1">&amp;&amp;</span>
            <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-c1">target</span><span class="pl-kos">.</span><span class="pl-c1">classList</span><span class="pl-kos">.</span><span class="pl-en">contains</span><span class="pl-kos">(</span><span class="pl-s">"lb-button-icon"</span><span class="pl-kos">)</span>
          <span class="pl-kos">)</span> <span class="pl-kos">{</span>
            <span class="pl-k">return</span><span class="pl-kos">;</span>
          <span class="pl-kos">}</span>

          <span class="pl-en">setMinimized</span><span class="pl-kos">(</span><span class="pl-c1">!</span><span class="pl-s1">minimized</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
        <span class="pl-kos">}</span><span class="pl-kos">}</span>
      <span class="pl-c1">&gt;</span>
        <span class="pl-c1">&lt;</span><span class="pl-ent">div</span>
          <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">'relative flex h-9 w-9 select-none items-center justify-center rounded-bl-full rounded-br-full rounded-tl-md rounded-tr-full bg-white shadow'</span>
          <span class="pl-c1">data-draggable</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-c1">true</span><span class="pl-kos">}</span>
        <span class="pl-c1">&gt;</span>
          <span class="pl-c1">&lt;</span><span class="pl-smi">Image</span>
            <span class="pl-c1">src</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s">`https://liveblocks.io/avatars/avatar-<span class="pl-s1"><span class="pl-kos">${</span><span class="pl-smi">Math</span><span class="pl-kos">.</span><span class="pl-en">floor</span><span class="pl-kos">(</span><span class="pl-smi">Math</span><span class="pl-kos">.</span><span class="pl-en">random</span><span class="pl-kos">(</span><span class="pl-kos">)</span> <span class="pl-c1">*</span> <span class="pl-c1">30</span><span class="pl-kos">)</span><span class="pl-kos">}</span></span>.png`</span><span class="pl-kos">}</span>
            <span class="pl-c1">alt</span><span class="pl-c1">=</span><span class="pl-s">'Dummy Name'</span>
            <span class="pl-c1">width</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-c1">28</span><span class="pl-kos">}</span>
            <span class="pl-c1">height</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-c1">28</span><span class="pl-kos">}</span>
            <span class="pl-c1">draggable</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-c1">false</span><span class="pl-kos">}</span>
            <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">'rounded-full'</span>
          <span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
        <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">div</span><span class="pl-c1">&gt;</span>
        <span class="pl-kos">{</span><span class="pl-c1">!</span><span class="pl-s1">minimized</span> ? <span class="pl-kos">(</span>
          <span class="pl-c1">&lt;</span><span class="pl-ent">div</span> <span class="pl-c1">className</span><span class="pl-c1">=</span><span class="pl-s">'flex min-w-60 flex-col overflow-hidden rounded-lg bg-white text-sm shadow'</span><span class="pl-c1">&gt;</span>
            <span class="pl-c1">&lt;</span><span class="pl-smi">Thread</span>
              <span class="pl-c1">thread</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-s1">thread</span><span class="pl-kos">}</span>
              <span class="pl-c1">indentCommentContent</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-c1">false</span><span class="pl-kos">}</span>
              <span class="pl-c1">onKeyUp</span><span class="pl-c1">=</span><span class="pl-kos">{</span><span class="pl-kos">(</span><span class="pl-s1">e</span><span class="pl-kos">)</span> <span class="pl-c1">=&gt;</span> <span class="pl-kos">{</span>
                <span class="pl-s1">e</span><span class="pl-kos">.</span><span class="pl-en">stopPropagation</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
              <span class="pl-kos">}</span><span class="pl-kos">}</span>
            <span class="pl-c1">/</span><span class="pl-c1">&gt;</span>
          <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">div</span><span class="pl-c1">&gt;</span>
        <span class="pl-kos">)</span> : <span class="pl-c1">null</span><span class="pl-kos">}</span>
      <span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-ent">div</span><span class="pl-c1">&gt;</span>
    <span class="pl-kos">)</span><span class="pl-kos">,</span>
    <span class="pl-kos">[</span><span class="pl-s1">thread</span><span class="pl-kos">.</span><span class="pl-c1">comments</span><span class="pl-kos">.</span><span class="pl-c1">length</span><span class="pl-kos">,</span> <span class="pl-s1">minimized</span><span class="pl-kos">]</span>
  <span class="pl-kos">)</span><span class="pl-kos">;</span>

  <span class="pl-k">return</span> <span class="pl-c1">&lt;</span><span class="pl-c1">&gt;</span><span class="pl-kos">{</span><span class="pl-s1">memoizedContent</span><span class="pl-kos">}</span><span class="pl-c1">&lt;</span><span class="pl-c1">/</span><span class="pl-c1">&gt;</span><span class="pl-kos">;</span>
<span class="pl-kos">}</span><span class="pl-kos">;</span></pre><div class="zeroclipboard-container">
    <clipboard-copy aria-label="Copy" class="ClipboardButton btn btn-invisible js-clipboard-copy m-2 p-0 tooltipped-no-delay d-flex flex-justify-center flex-items-center" data-copy-feedback="Copied!" data-tooltip-direction="w" value="&quot;use client&quot;;

import Image from &quot;next/image&quot;;
import { useMemo, useState } from &quot;react&quot;;
import { ThreadData } from &quot;@liveblocks/client&quot;;
import { Thread } from &quot;@liveblocks/react-comments&quot;;

import { ThreadMetadata } from &quot;@/liveblocks.config&quot;;

type Props = {
  thread: ThreadData<ThreadMetadata>;
  onFocus: (threadId: string) => void;
};

export const PinnedThread = ({ thread, onFocus, ...props }: Props) => {
  // Open pinned threads that have just been created
  const startMinimized = useMemo(
    () => Number(new Date()) - Number(new Date(thread.createdAt)) > 100,
    [thread]
  );

  const [minimized, setMinimized] = useState(startMinimized);

  /**
   * memoize the result of this function so that it doesn't change on every render but only when the thread changes
   * Memo is used to optimize performance and avoid unnecessary re-renders.
   *
   * useMemo: https://react.dev/reference/react/useMemo
   */

  const memoizedContent = useMemo(
    () => (
      <div
        className='absolute flex cursor-pointer gap-4'
        {...props}
        onClick={(e: any) => {
          onFocus(thread.id);

          // check if click is on/in the composer
          if (
            e.target &amp;&amp;
            e.target.classList.contains(&quot;lb-icon&quot;) &amp;&amp;
            e.target.classList.contains(&quot;lb-button-icon&quot;)
          ) {
            return;
          }

          setMinimized(!minimized);
        }}
      >
        <div
          className='relative flex h-9 w-9 select-none items-center justify-center rounded-bl-full rounded-br-full rounded-tl-md rounded-tr-full bg-white shadow'
          data-draggable={true}
        >
          <Image
            src={`https://liveblocks.io/avatars/avatar-${Math.floor(Math.random() * 30)}.png`}
            alt='Dummy Name'
            width={28}
            height={28}
            draggable={false}
            className='rounded-full'
          />
        </div>
        {!minimized ? (
          <div className='flex min-w-60 flex-col overflow-hidden rounded-lg bg-white text-sm shadow'>
            <Thread
              thread={thread}
              indentCommentContent={false}
              onKeyUp={(e) => {
                e.stopPropagation();
              }}
            />
          </div>
        ) : null}
      </div>
    ),
    [thread.comments.length, minimized]
  );

  return <>{memoizedContent}</>;
};" tabindex="0" role="button">
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-copy js-clipboard-copy-icon">
    <path d="M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"></path><path d="M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"></path>
</svg>
      <svg aria-hidden="true" height="16" viewBox="0 0 16 16" version="1.1" width="16" data-view-component="true" class="octicon octicon-check js-clipboard-check-icon color-fg-success d-none">
    <path d="M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"></path>
</svg>
    </clipboard-copy>
  </div></div>
</details>
<h2 tabindex="-1" dir="auto"><a id="user-content--links" class="anchor" aria-hidden="true" tabindex="-1" href="#-links"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><a name="user-content-links"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🔗 链接</font></font></a></h2>
<ul dir="auto">
<li><a href="https://drive.google.com/file/d/17tRs0sEiIsCeTYEXhWEdHMrTshuz2oYf/view?usp=sharing" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">资产</font></font></a></li>
<li><a href="https://drive.google.com/file/d/1bha-40vlGMIPW9bTRUgHD_SEmT9ZA38S/view?usp=sharing" rel="nofollow"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成分</font></font></a></li>
</ul>
<h2 tabindex="-1" dir="auto"><a id="user-content--more" class="anchor" aria-hidden="true" tabindex="-1" href="#-more"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5 0 1 1 4.95 4.95l-2.5 2.5a3.5 3.5 0 0 1-4.95 0 .751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018 1.998 1.998 0 0 0 2.83 0l2.5-2.5a2.002 2.002 0 0 0-2.83-2.83l-1.25 1.25a.751.751 0 0 1-1.042-.018.751.751 0 0 1-.018-1.042Zm-4.69 9.64a1.998 1.998 0 0 0 2.83 0l1.25-1.25a.751.751 0 0 1 1.042.018.751.751 0 0 1 .018 1.042l-1.25 1.25a3.5 3.5 0 1 1-4.95-4.95l2.5-2.5a3.5 3.5 0 0 1 4.95 0 .751.751 0 0 1-.018 1.042.751.751 0 0 1-1.042.018 1.998 1.998 0 0 0-2.83 0l-2.5 2.5a1.998 1.998 0 0 0 0 2.83Z"></path></svg></a><a name="user-content-more"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">🚀 更多</font></font></a></h2>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过 Next.js 14 专业课程提升您的技能</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">喜欢创建这个项目吗？深入学习我们的 PRO 课程，享受更丰富的学习冒险。它们充满了详细的解释、炫酷的功能以及可提高您的技能的练习。搏一搏！</font></font></p>
<a href="https://jsmastery.pro/next14" rel="nofollow">
<img src="https://private-user-images.githubusercontent.com/151519281/289158181-557837ce-f612-4530-ab24-189e75133c71.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDcyMTU3NTQsIm5iZiI6MTcwNzIxNTQ1NCwicGF0aCI6Ii8xNTE1MTkyODEvMjg5MTU4MTgxLTU1NzgzN2NlLWY2MTItNDUzMC1hYjI0LTE4OWU3NTEzM2M3MS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwMjA2JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDIwNlQxMDMwNTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT00MTAzYzA3ZTU2MjYxOGY3OTFmY2I3MmFhOTYxZmJhMGY1NjlkNzI4ODBhM2E2ZTdmZDA3NTdlNWE5ZWNiNzQ4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.IGSxSSNB-XgoMi4jLjG_QJB6jOu6zWGR0drgk4ZjabU" alt="项目横幅" secured-asset-link="" style="max-width: 100%;">
</a>
<br>
<br>
<p dir="auto"><strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通过专家培训计划加速您的职业之旅</font></font></strong></p>
<p dir="auto"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您不仅仅渴望一门课程，并且想了解我们如何学习和应对技术挑战，请参加我们的个性化大师班。我们涵盖最佳实践、不同的网络技能，并提供指导以增强您的信心。让我们一起学习、一起成长！</font></font></p>
<a href="https://www.jsmastery.pro/masterclass" rel="nofollow">
<img src="https://private-user-images.githubusercontent.com/151519281/289158263-fed352ad-f27b-400d-9b8f-c7fe628acb84.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MDcyMTU3NTQsIm5iZiI6MTcwNzIxNTQ1NCwicGF0aCI6Ii8xNTE1MTkyODEvMjg5MTU4MjYzLWZlZDM1MmFkLWYyN2ItNDAwZC05YjhmLWM3ZmU2MjhhY2I4NC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjQwMjA2JTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI0MDIwNlQxMDMwNTRaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT01NzI5MWNkMDA4ZWVmNGRmY2QyMzc0ZmJkMmE2NjUwZDFiOWI2YWYyNDE3ZWVkYzE0ZjkwZGY0NzFjZjY1NjFiJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCZhY3Rvcl9pZD0wJmtleV9pZD0wJnJlcG9faWQ9MCJ9.AaAfjZabRLLQOLS4bGBepZ9535IA5Vpgeet6b2PqAUg" alt="项目横幅" secured-asset-link="" style="max-width: 100%;">
</a>
<h1 dir="auto"></h1>
</article></div>
